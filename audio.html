<h1>Keep this page open in a separate tab!</h1>
<h2>Audio will play through it.</h2>
<h3>Head back to Slack to play Small Sacrifices.</h3>

<script src="https://cdn.socket.io/socket.io-1.4.5.js"></script>

<audio id="level1music - oneshot" src="/Level 1 - Stem 1 (One-Shot).ogg" autoplay/>
<audio id="level1music - loop" src="/Level 1 - Stem 2 (Looping).ogg" loop/>
<audio id="level2music - oneshot" src="/Level 2 - Stem 1 (One-Shot).ogg" />
<audio id="level2music - loop" src="/Level 2 - Stem 2 (Looping).ogg" loop/>
<audio id="level3music - loop" src="/Level 3 - Stem 1 (Looping).ogg" loop/>
<audio id="level4music - loop" src="/Level 4 - Stem 1 (Looping).ogg" loop/>
<audio id="level5music - loop" src="/Level 5 - Stem 1 (Looping).ogg" loop/>


<script>
	userID = window.location.pathname.split('/')[2]

	// 1-based -> 0-based

	level0MusicOneShot = document.getElementById("level1music - oneshot")
	level0MusicLoop = document.getElementById('level1music - loop')
	level1MusicOneShot = document.getElementById("level2music - oneshot")
	level1MusicLoop = document.getElementById('level2music - loop')
	level2MusicLoop = document.getElementById('level3music - loop')
	level3MusicLoop = document.getElementById('level4music - loop')
	level4MusicLoop = document.getElementById('level5music - loop')

	setTimeout(function() {
		level0MusicLoop.play()
	}, 89302)
	var socket = io();


	socket.on("play_audio", function(data) {
		if (data.for == userID) {
			console.log("got data for me!");
			console.log(data);
			if ("level" in data) {
				if (data.level == 1) {
					// need to crossfade, duh
					level0MusicLoop.pause()
					level1MusicOneShot.play()
					setTimeout(function() {
						level1MusicLoop.play()
					}, 89302)
				} else if (data.level == 2) {
					// crossfade, duh
					level1MusicLoop.pause()
					level2MusicLoop.play()
				} else if (data.level == 3) {
					// crossfade, duh
					level2MusicLoop.pause()
					level3MusicLoop.play()
				} else if (data.level == 4) {
					// crossfade, duh
					level3MusicLoop.pause()
					level4MusicLoop.play()
				}
			}
		}
	})

	function crossfade(audioFadeOut, audioFadeIn) {

	}



</script>
